2024-03-26T14:23:16.139411284Z > user-management-service@1.0.0 start
2024-03-26T14:23:16.139414984Z > node src/app.js
2024-03-26T14:23:16.139417585Z
2024-03-26T14:23:17.732240852Z (node:19) [SEQUELIZE0002] DeprecationWarning: The logging-option should be either a function or false. Default: console.log
2024-03-26T14:23:17.732266653Z (Use `node --trace-deprecation ...` to show where the warning was created)
2024-03-26T14:23:17.733367474Z Server běží na portu 3001
2024-03-26T14:23:17.794641361Z Executing (default): SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE' AND TABLE_NAME = 'users' AND TABLE_SCHEMA = 'GymNestUserDB'
2024-03-26T14:23:17.797707521Z Executing (default): CREATE TABLE IF NOT EXISTS `users` (`id` INTEGER NOT NULL auto_increment , `username` VARCHAR(255) NOT NULL UNIQUE, `passwordHash` VARCHAR(255) NOT NULL, `email` VARCHAR(255) NOT NULL UNIQUE, `roleId` INTEGER, `preferredCurrency` VARCHAR(255) DEFAULT 'CZK', `colorScheme` VARCHAR(255) DEFAULT 'light', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, PRIMARY KEY (`id`), FOREIGN KEY (`roleId`) REFERENCES `Roles` (`id`)) ENGINE=InnoDB;
2024-03-26T14:23:17.856705064Z Při synchronizaci databáze došlo k chybě: Error
2024-03-26T14:23:17.856843067Z     at Query.run (/usr/src/user-management-service/node_modules/sequelize/lib/dialects/mysql/query.js:52:25)
2024-03-26T14:23:17.856848867Z     at /usr/src/user-management-service/node_modules/sequelize/lib/sequelize.js:315:28
2024-03-26T14:23:17.856851567Z     at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
2024-03-26T14:23:17.856854167Z     at async MySQLQueryInterface.createTable (/usr/src/user-management-service/node_modules/sequelize/lib/dialects/abstract/query-interface.js:98:12)
2024-03-26T14:23:17.856856667Z     at async User.sync (/usr/src/user-management-service/node_modules/sequelize/lib/model.js:942:7)
2024-03-26T14:23:17.856858967Z     at async Sequelize.sync (/usr/src/user-management-service/node_modules/sequelize/lib/sequelize.js:377:9) {
2024-03-26T14:23:17.856879368Z   name: 'SequelizeDatabaseError',
2024-03-26T14:23:17.856882468Z   parent: Error: Cannot add foreign key constraint
2024-03-26T14:23:17.856894168Z       at Packet.asError (/usr/src/user-management-service/node_modules/mysql2/lib/packets/packet.js:728:17)
2024-03-26T14:23:17.856896868Z       at Query.execute (/usr/src/user-management-service/node_modules/mysql2/lib/commands/command.js:29:26)
2024-03-26T14:23:17.856899168Z       at Connection.handlePacket (/usr/src/user-management-service/node_modules/mysql2/lib/connection.js:481:34)
2024-03-26T14:23:17.856901468Z       at PacketParser.onPacket (/usr/src/user-management-service/node_modules/mysql2/lib/connection.js:97:12)
2024-03-26T14:23:17.856903768Z       at PacketParser.executeStart (/usr/src/user-management-service/node_modules/mysql2/lib/packet_parser.js:75:16)
2024-03-26T14:23:17.856906068Z       at Socket.<anonymous> (/usr/src/user-management-service/node_modules/mysql2/lib/connection.js:104:25)
2024-03-26T14:23:17.856908968Z       at Socket.emit (node:events:519:28)
2024-03-26T14:23:17.856911168Z       at addChunk (node:internal/streams/readable:559:12)
2024-03-26T14:23:17.856913468Z       at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)
2024-03-26T14:23:17.856915768Z       at Readable.push (node:internal/streams/readable:390:5) {
2024-03-26T14:23:17.856917968Z     code: 'ER_CANNOT_ADD_FOREIGN',
2024-03-26T14:23:17.856920268Z     errno: 1215,
2024-03-26T14:23:17.856922468Z     sqlState: 'HY000',
2024-03-26T14:23:17.856924668Z     sqlMessage: 'Cannot add foreign key constraint',
2024-03-26T14:23:17.856928968Z     sql: "CREATE TABLE IF NOT EXISTS `users` (`id` INTEGER NOT NULL auto_increment , `username` VARCHAR(255) NOT NULL UNIQUE, `passwordHash` VARCHAR(255) NOT NULL, `email` VARCHAR(255) NOT NULL UNIQUE, `roleId` INTEGER, `preferredCurrency` VARCHAR(255) DEFAULT 'CZK', `colorScheme` VARCHAR(255) DEFAULT 'light', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, PRIMARY KEY (`id`), FOREIGN KEY (`roleId`) REFERENCES `Roles` (`id`)) ENGINE=InnoDB;",
2024-03-26T14:23:17.856932869Z     parameters: undefined
2024-03-26T14:23:17.856935169Z   },
2024-03-26T14:23:17.856937469Z   original: Error: Cannot add foreign key constraint
2024-03-26T14:23:17.856939669Z       at Packet.asError (/usr/src/user-management-service/node_modules/mysql2/lib/packets/packet.js:728:17)
2024-03-26T14:23:17.856941969Z       at Query.execute (/usr/src/user-management-service/node_modules/mysql2/lib/commands/command.js:29:26)
2024-03-26T14:23:17.856944369Z       at Connection.handlePacket (/usr/src/user-management-service/node_modules/mysql2/lib/connection.js:481:34)
2024-03-26T14:23:17.856946669Z       at PacketParser.onPacket (/usr/src/user-management-service/node_modules/mysql2/lib/connection.js:97:12)
2024-03-26T14:23:17.856948969Z       at PacketParser.executeStart (/usr/src/user-management-service/node_modules/mysql2/lib/packet_parser.js:75:16)
2024-03-26T14:23:17.856951269Z       at Socket.<anonymous> (/usr/src/user-management-service/node_modules/mysql2/lib/connection.js:104:25)
2024-03-26T14:23:17.856953669Z       at Socket.emit (node:events:519:28)
2024-03-26T14:23:17.856955869Z       at addChunk (node:internal/streams/readable:559:12)
2024-03-26T14:23:17.856960969Z       at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)
2024-03-26T14:23:17.856963369Z       at Readable.push (node:internal/streams/readable:390:5) {
2024-03-26T14:23:17.856965569Z     code: 'ER_CANNOT_ADD_FOREIGN',
2024-03-26T14:23:17.856967769Z     errno: 1215,
2024-03-26T14:23:17.856970069Z     sqlState: 'HY000',
2024-03-26T14:23:17.856972269Z     sqlMessage: 'Cannot add foreign key constraint',
2024-03-26T14:23:17.856974569Z     sql: "CREATE TABLE IF NOT EXISTS `users` (`id` INTEGER NOT NULL auto_increment , `username` VARCHAR(255) NOT NULL UNIQUE, `passwordHash` VARCHAR(255) NOT NULL, `email` VARCHAR(255) NOT NULL UNIQUE, `roleId` INTEGER, `preferredCurrency` VARCHAR(255) DEFAULT 'CZK', `colorScheme` VARCHAR(255) DEFAULT 'light', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, PRIMARY KEY (`id`), FOREIGN KEY (`roleId`) REFERENCES `Roles` (`id`)) ENGINE=InnoDB;",
2024-03-26T14:23:17.856977569Z     parameters: undefined
2024-03-26T14:23:17.856979769Z   },
2024-03-26T14:23:17.856982270Z   sql: "CREATE TABLE IF NOT EXISTS `users` (`id` INTEGER NOT NULL auto_increment , `username` VARCHAR(255) NOT NULL UNIQUE, `passwordHash` VARCHAR(255) NOT NULL, `email` VARCHAR(255) NOT NULL UNIQUE, `roleId` INTEGER, `preferredCurrency` VARCHAR(255) DEFAULT 'CZK', `colorScheme` VARCHAR(255) DEFAULT 'light', `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, PRIMARY KEY (`id`), FOREIGN KEY (`roleId`) REFERENCES `Roles` (`id`)) ENGINE=InnoDB;",
2024-03-26T14:23:17.856985170Z   parameters: {}
2024-03-26T14:23:17.856987470Z }
